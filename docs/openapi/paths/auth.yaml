register:
  post:
    summary: Register a new user
    description: Create a user account with a username, email, and password.
    operationId: registerUser
    tags: [auth]
    requestBody:
      description: Registration payload.
      required: true
      content:
        application/json:
          schema:
            type: object
            required: [username, email, password]
            properties:
              username: { type: string }
              email: { type: string }
              password: { type: string, format: password }
    responses:
      "201":
        description: User created
        content:
          application/json:
            schema:
              $ref: ../openapi.yaml#/components/schemas/User
            examples:
              alice:
                value:
                  id: 1
                  username: "alice"
                  email: "alice@example.com"
              bob:
                value:
                  id: 2
                  username: "bob"
                  email: "bob@example.com"
      "400":
        description: Validation error
        content:
          application/json:
            schema:
              $ref: ../openapi.yaml#/components/schemas/ValidationError
            examples:
              missing-fields:
                value:
                  errors:
                    username: "Username is required."
                    email: "Email is required."
                    password: "Password is required."
      "409":
        description: Username or email already taken
        content:
          application/json:
            schema:
              $ref: ../openapi.yaml#/components/schemas/ConflictError
            examples:
              username-taken:
                value:
                  error: "Username already taken"
                  field: "username"
              email-taken:
                value:
                  error: "Email already taken"
                  field: "email"

login:
  post:
    summary: Login
    description: Authenticate a user with email and password credentials.
    operationId: loginUser
    tags: [auth]
    requestBody:
      description: Login credentials.
      required: true
      content:
        application/json:
          schema:
            type: object
            required: [email, password]
            properties:
              email: { type: string }
              password: { type: string, format: password }
    responses:
      "200":
        description: Login successful
        content:
          application/json:
            schema:
              $ref: ../openapi.yaml#/components/schemas/User
            examples:
              login-ok:
                value:
                  id: 1
                  username: "alice"
                  email: "alice@example.com"
      "401":
        description: Invalid credentials
        content:
          application/json:
            schema:
              $ref: ../openapi.yaml#/components/schemas/AuthError
            examples:
              invalid-credentials:
                value:
                  error: "Wrong email or password"
